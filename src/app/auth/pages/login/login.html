<app-auth-card
  title="Bienvenido de vuelta"
  subtitle="Descubre nuevas películas y libros recomendados por nuestra comunidad"
>
  <form [formGroup]="form" class="mt-4 w-full">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Correo electrónico</mat-label>
      <input matInput formControlName="email" type="email" autocomplete="email" />
      <mat-icon matPrefix>email</mat-icon>
      @if (form.get('email')?.hasError('required') && form.get('email')?.touched) {
      <mat-error>Correo electrónico requerido</mat-error>
      } @if (form.get('email')?.hasError('email') && form.get('email')?.touched) {
      <mat-error>Correo electrónico inválido</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Contraseña</mat-label>
      <input
        matInput
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="password"
        autocomplete="current-password"
      />
      <mat-icon matPrefix>lock</mat-icon>
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="togglePasswordVisibility()"
        [attr.aria-label]="'Ocultar contraseña'"
        [attr.aria-pressed]="!hidePassword"
        class="mr-2"
      >
        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      @if (form.get('password')?.hasError('required') && form.get('password')?.touched) {
      <mat-error>Contraseña es requerida</mat-error>
      } @if (form.get('password')?.hasError('minlength') && form.get('password')?.touched) {
      <mat-error>La contraseña debe tener al menos 6 caracteres</mat-error>
      }
    </mat-form-field>

    <button
      mat-fab
      extended
      [disabled]="isLoading || form.invalid"
      class="!w-full"
      (click)="login()"
    >
      @if (isLoading) { Iniciando sesión... } @else { Iniciar sesión }
    </button>
  </form>
  <div class="flex items-center mt-2">
    <div class="flex-1 border-t border-gray-600"></div>
    <span class="mx-4 text-black text-sm">O</span>
    <div class="flex-1 border-t border-gray-600"></div>
  </div>

  <div class="flex justify-center mt-2 w-full">
    <button
      mat-stroked-button
      (click)="loginWithGoogle()"
      class="w-full flex items-center justify-between px-4 py-3"
    >
      <div class="flex items-center gap-2 mx-auto">
        <img src="assets/images/googleIcon.png" alt="Google" class="w-6 h-6" />
        <span>Iniciar sesión con Google</span>
      </div>
    </button>
  </div>

  <a
    class="mt-3 md:mt-5 lg:mt-5 2xl:mt-5 3xl:mt-5 font-medium text-sm text-[#9811FB]"
    routerLink="/auth/recover-password"
  >
    ¿Olvidaste tu contraseña?
  </a>

  <div class="flex-row">
    <span class="font-medium text-sm">¿No tienes una cuenta?</span>
    <a class="font-medium text-sm text-[#9811FB]" routerLink="/auth/register"> Regístrate aquí</a>
  </div>
</app-auth-card>
